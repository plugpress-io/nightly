(()=>{"use strict";var t={459:(t,e,n)=>{t=n.hmd(t);class a{constructor(t={}){this.storageKey="nightly-theme-preference",this.htmlAttribute="data-nightly-theme",this.themes={LIGHT:"light",DARK:"dark"},this.options={respectSystemPreference:!0,transitionDuration:200,intensity:.8,contrast:1,brightness:.9,sepia:.1,...t},this.styleElement=null,this.observer=null,this.processedElements=new WeakSet,this.init()}init(){this.loadSavedTheme(),this.bindEvents(),this.setupSystemPreferenceListener(),this.setupDynamicStyleInjection(),this.maybeCreateFloatingToggle(),this.createDebugIndicator()}loadSavedTheme(){let t=this.getSavedTheme();!t&&this.options.respectSystemPreference&&(t=this.getSystemPreference()),t||(t=this.themes.LIGHT),this.setTheme(t,!1)}getSavedTheme(){try{const t=localStorage.getItem(this.storageKey);if(t&&Object.values(this.themes).includes(t))return t}catch(t){console.warn("Nightly: localStorage not available")}return null}getSystemPreference(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?this.themes.DARK:this.themes.LIGHT}saveTheme(t){try{localStorage.setItem(this.storageKey,t)}catch(t){console.warn("Nightly: Could not save theme preference")}}getCurrentTheme(){return document.documentElement.getAttribute(this.htmlAttribute)||this.themes.LIGHT}setTheme(t,e=!0){Object.values(this.themes).includes(t)?(console.log(`Nightly: Setting theme to ${t}`),document.documentElement.setAttribute(this.htmlAttribute,t),this.applyDynamicStyles(t),this.updateToggleButtons(t),e&&this.saveTheme(t),this.dispatchThemeChangeEvent(t),console.log(`Nightly: HTML data attribute is now: ${document.documentElement.getAttribute(this.htmlAttribute)}`)):console.warn(`Nightly: Invalid theme "${t}"`)}toggle(){const t=this.getCurrentTheme()===this.themes.DARK?this.themes.LIGHT:this.themes.DARK;this.setTheme(t)}updateToggleButtons(t){document.querySelectorAll("[data-nightly-toggle]").forEach(e=>{e.setAttribute("aria-pressed",t===this.themes.DARK?"true":"false");const n=e.querySelector(".nightly-sr-state");n&&(n.textContent=`Current theme: ${t}`);const a=e.querySelector(".nightly-toggle-text");if(a&&(e.hasAttribute("data-light-text")||e.hasAttribute("data-dark-text"))){const n=e.getAttribute("data-light-text")||"Switch to dark mode",i=e.getAttribute("data-dark-text")||"Switch to light mode";a.textContent=t===this.themes.DARK?i:n}const i=e.querySelector(".nightly-toggle-switch");i&&(t===this.themes.DARK?i.classList.add("is-checked"):i.classList.remove("is-checked"))})}dispatchThemeChangeEvent(t){const e=new CustomEvent("nightlyThemeChange",{detail:{theme:t,timestamp:Date.now()}});document.dispatchEvent(e)}bindEvents(){document.addEventListener("click",t=>{t.target.closest("[data-nightly-toggle]")&&(t.preventDefault(),this.toggle())}),document.addEventListener("keydown",t=>{!t.target.closest("[data-nightly-toggle]")||"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.toggle())})}setupSystemPreferenceListener(){if(!this.options.respectSystemPreference||!window.matchMedia)return;const t=window.matchMedia("(prefers-color-scheme: dark)"),e=t=>{if(!this.getSavedTheme()){const e=t.matches?this.themes.DARK:this.themes.LIGHT;this.setTheme(e,!1)}};t.addEventListener?t.addEventListener("change",e):t.addListener&&t.addListener(e)}maybeCreateFloatingToggle(){const t=document.getElementById("nightly-floating-toggle-placeholder");t&&"true"===t.getAttribute("data-auto-inject")&&(document.querySelectorAll('[data-nightly-toggle]:not([data-nightly-toggle="floating"])').length>0||this.createFloatingToggle())}createFloatingToggle(){const t=(window.nightlySettings||{}).floatingPosition||"bottom-right",e=document.createElement("button");e.className=`nightly-toggle-button nightly-floating-toggle position-${t}`,e.setAttribute("data-nightly-toggle","floating"),e.setAttribute("type","button"),e.setAttribute("aria-pressed","false"),e.setAttribute("aria-label","Toggle between light and dark mode"),e.setAttribute("title","Toggle dark mode");const n=document.createElement("span");n.className="nightly-toggle-switch",n.setAttribute("aria-hidden","true");const a=document.createElement("span");a.className="nightly-toggle-track";const i=document.createElement("span");i.className="nightly-toggle-thumb",i.innerHTML='\n\t\t\t<svg class="nightly-icon nightly-icon-sun" width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/>\n\t\t\t\t<path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 6.34L4.93 4.93M19.07 19.07l-1.41-1.41" stroke="currentColor" stroke-width="2"/>\n\t\t\t</svg>\n\t\t\t<svg class="nightly-icon nightly-icon-moon" width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" fill="currentColor"/>\n\t\t\t</svg>\n\t\t',a.appendChild(i),n.appendChild(a),e.appendChild(n);const r=document.createElement("span");r.className="screen-reader-text nightly-sr-state",r.textContent="Current theme: light",e.appendChild(r),document.body.appendChild(e),this.floatingToggle=e}createDebugIndicator(){const t=window.nightlySettings||{},e=new URLSearchParams(window.location.search);if(!t.debug&&!e.has("nightly-debug"))return;const n=document.createElement("div");n.className="nightly-debug-indicator",n.textContent="Nightly Debug",document.body.appendChild(n),this.debugIndicator=n}setupDynamicStyleInjection(){this.styleElement=document.createElement("style"),this.styleElement.id="nightly-dynamic-styles",document.head.appendChild(this.styleElement),window.MutationObserver&&(this.observer=new MutationObserver(t=>{let e=!1;t.forEach(t=>{if("childList"===t.type&&t.addedNodes.length>0)for(let n of t.addedNodes)if(n.nodeType===Node.ELEMENT_NODE){e=!0;break}}),e&&this.getCurrentTheme()===this.themes.DARK&&(clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.applyDynamicStyles(this.themes.DARK)},100))}),this.observer.observe(document.body,{childList:!0,subtree:!0}))}applyDynamicStyles(t){this.styleElement&&(t===this.themes.DARK?this.styleElement.textContent=this.generateDarkModeCSS():this.styleElement.textContent="")}generateDarkModeCSS(){const{intensity:t,contrast:e,brightness:n,sepia:a}=this.options;let i=`\n\t\t\t/* Nightly Dynamic Dark Mode Styles */\n\t\t\thtml[data-nightly-theme="dark"] {\n\t\t\t\tfilter: invert(${t}) contrast(${e}) brightness(${n}) sepia(${a});\n\t\t\t}\n\n\t\t\t/* Preserve images, videos, and media */\n\t\t\thtml[data-nightly-theme="dark"] img,\n\t\t\thtml[data-nightly-theme="dark"] video,\n\t\t\thtml[data-nightly-theme="dark"] iframe,\n\t\t\thtml[data-nightly-theme="dark"] svg,\n\t\t\thtml[data-nightly-theme="dark"] canvas,\n\t\t\thtml[data-nightly-theme="dark"] embed,\n\t\t\thtml[data-nightly-theme="dark"] object {\n\t\t\t\tfilter: invert(${t}) contrast(${1/e}) brightness(${1/n}) sepia(${-a});\n\t\t\t}\n\n\t\t\t/* Preserve elements that should stay in original colors */\n\t\t\thtml[data-nightly-theme="dark"] [data-nightly-preserve],\n\t\t\thtml[data-nightly-theme="dark"] .nightly-preserve,\n\t\t\thtml[data-nightly-theme="dark"] .wp-block-image,\n\t\t\thtml[data-nightly-theme="dark"] .wp-block-video,\n\t\t\thtml[data-nightly-theme="dark"] .wp-block-gallery,\n\t\t\thtml[data-nightly-theme="dark"] .wp-block-media-text__media {\n\t\t\t\tfilter: invert(${t}) contrast(${1/e}) brightness(${1/n}) sepia(${-a});\n\t\t\t}\n\n\t\t\t/* Smooth transitions */\n\t\t\thtml[data-nightly-theme="dark"],\n\t\t\thtml[data-nightly-theme="dark"] * {\n\t\t\t\ttransition: filter ${this.options.transitionDuration}ms ease !important;\n\t\t\t}\n\n\t\t\t/* Fix for already dark elements */\n\t\t\thtml[data-nightly-theme="dark"] [style*="background: #000"],\n\t\t\thtml[data-nightly-theme="dark"] [style*="background-color: #000"],\n\t\t\thtml[data-nightly-theme="dark"] [style*="background: rgb(0"],\n\t\t\thtml[data-nightly-theme="dark"] .bg-black,\n\t\t\thtml[data-nightly-theme="dark"] .bg-dark {\n\t\t\t\tfilter: invert(0) !important;\n\t\t\t}\n\t\t`;return i+=this.generateThemeSpecificCSS(),i+=this.generateAccessibilityCSS(),i}generateThemeSpecificCSS(){let t="";t+='\n\t\t\thtml[data-nightly-theme="dark"] #wpadminbar {\n\t\t\t\tfilter: none !important;\n\t\t\t}\n\t\t',t+='\n\t\t\t/* GeneratePress theme compatibility */\n\t\t\thtml[data-nightly-theme="dark"] .site-header,\n\t\t\thtml[data-nightly-theme="dark"] .main-navigation,\n\t\t\thtml[data-nightly-theme="dark"] .site-content,\n\t\t\thtml[data-nightly-theme="dark"] .content-area,\n\t\t\thtml[data-nightly-theme="dark"] .site-main,\n\t\t\thtml[data-nightly-theme="dark"] .generate-columns-container,\n\t\t\thtml[data-nightly-theme="dark"] .inside-article,\n\t\t\thtml[data-nightly-theme="dark"] .entry-content,\n\t\t\thtml[data-nightly-theme="dark"] .site-footer {\n\t\t\t\tbackground-color: transparent !important;\n\t\t\t}\n\n\t\t\t/* GeneratePress specific sections that need better handling */\n\t\t\thtml[data-nightly-theme="dark"] .separate-containers .inside-article,\n\t\t\thtml[data-nightly-theme="dark"] .separate-containers .comments-area,\n\t\t\thtml[data-nightly-theme="dark"] .separate-containers .page-header,\n\t\t\thtml[data-nightly-theme="dark"] .one-container .site-content {\n\t\t\t\tbackground-color: #2a2a2a !important;\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t}\n\n\t\t\t/* GeneratePress navigation improvements */\n\t\t\thtml[data-nightly-theme="dark"] .main-navigation a,\n\t\t\thtml[data-nightly-theme="dark"] .menu-toggle,\n\t\t\thtml[data-nightly-theme="dark"] .dropdown-menu a {\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t}\n\n\t\t\t/* GeneratePress widget areas */\n\t\t\thtml[data-nightly-theme="dark"] .widget-area,\n\t\t\thtml[data-nightly-theme="dark"] .sidebar .widget {\n\t\t\t\tbackground-color: #2a2a2a !important;\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t}\n\t\t',[".elementor-widget-image",".et_pb_image",".vc_single_image-wrapper",".wp-block-cover",".has-background",'[style*="background-image"]',".wp-block-image",".wp-block-gallery"].forEach(e=>{t+=`\n\t\t\t\thtml[data-nightly-theme="dark"] ${e} {\n\t\t\t\t\tfilter: invert(${this.options.intensity}) contrast(${1/this.options.contrast}) brightness(${1/this.options.brightness}) sepia(${-this.options.sepia});\n\t\t\t\t}\n\t\t\t`});const e=document.body.className;return(e.includes("generate-")||document.querySelector(".generate-columns-container"))&&(t+=this.generateGeneratePressCSS()),(e.includes("ast-")||document.querySelector(".ast-container"))&&(t+=this.generateAstraCSS()),(e.includes("et_")||document.querySelector(".et_pb_section"))&&(t+=this.generateDiviCSS()),t}generateGeneratePressCSS(){return'\n\t\t\t/* Enhanced GeneratePress compatibility */\n\t\t\thtml[data-nightly-theme="dark"] .generate-columns,\n\t\t\thtml[data-nightly-theme="dark"] .generate-columns-container .inside-article {\n\t\t\t\tbackground-color: #2a2a2a !important;\n\t\t\t\tborder-color: #444 !important;\n\t\t\t}\n\n\t\t\thtml[data-nightly-theme="dark"] .gp-icon,\n\t\t\thtml[data-nightly-theme="dark"] .generate-back-to-top {\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t}\n\n\t\t\t/* GeneratePress forms */\n\t\t\thtml[data-nightly-theme="dark"] input[type="text"],\n\t\t\thtml[data-nightly-theme="dark"] input[type="email"],\n\t\t\thtml[data-nightly-theme="dark"] input[type="search"],\n\t\t\thtml[data-nightly-theme="dark"] textarea,\n\t\t\thtml[data-nightly-theme="dark"] select {\n\t\t\t\tbackground-color: #333 !important;\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t\tborder-color: #555 !important;\n\t\t\t}\n\n\t\t\t/* GeneratePress buttons */\n\t\t\thtml[data-nightly-theme="dark"] .button,\n\t\t\thtml[data-nightly-theme="dark"] button,\n\t\t\thtml[data-nightly-theme="dark"] input[type="button"],\n\t\t\thtml[data-nightly-theme="dark"] input[type="submit"] {\n\t\t\t\tbackground-color: #4A90E2 !important;\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t\tborder-color: #4A90E2 !important;\n\t\t\t}\n\t\t'}generateAstraCSS(){return'\n\t\t\t/* Enhanced Astra compatibility */\n\t\t\thtml[data-nightly-theme="dark"] .ast-article-post,\n\t\t\thtml[data-nightly-theme="dark"] .ast-separate-container .ast-article-post,\n\t\t\thtml[data-nightly-theme="dark"] .ast-separate-container .ast-article-single {\n\t\t\t\tbackground-color: #2a2a2a !important;\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t}\n\t\t'}generateDiviCSS(){return'\n\t\t\t/* Enhanced Divi compatibility */\n\t\t\thtml[data-nightly-theme="dark"] .et_pb_section:not([style*="background"]),\n\t\t\thtml[data-nightly-theme="dark"] .et_pb_row:not([style*="background"]) {\n\t\t\t\tbackground-color: transparent !important;\n\t\t\t}\n\n\t\t\thtml[data-nightly-theme="dark"] .et_pb_text,\n\t\t\thtml[data-nightly-theme="dark"] .et_pb_blurb_content {\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t}\n\t\t'}generateAccessibilityCSS(){return'\n\t\t\t/* Ensure focus indicators remain visible */\n\t\t\thtml[data-nightly-theme="dark"] *:focus {\n\t\t\t\toutline: 2px solid #4A90E2 !important;\n\t\t\t\toutline-offset: 2px !important;\n\t\t\t}\n\n\t\t\t/* Improve text contrast on light backgrounds */\n\t\t\thtml[data-nightly-theme="dark"] [style*="background: #fff"],\n\t\t\thtml[data-nightly-theme="dark"] [style*="background-color: #fff"],\n\t\t\thtml[data-nightly-theme="dark"] [style*="background: rgb(255"],\n\t\t\thtml[data-nightly-theme="dark"] .bg-white,\n\t\t\thtml[data-nightly-theme="dark"] .bg-light {\n\t\t\t\tcolor: #333 !important;\n\t\t\t}\n\n\t\t\t/* Preserve readability for form elements */\n\t\t\thtml[data-nightly-theme="dark"] input,\n\t\t\thtml[data-nightly-theme="dark"] textarea,\n\t\t\thtml[data-nightly-theme="dark"] select {\n\t\t\t\tbackground-color: #2a2a2a !important;\n\t\t\t\tcolor: #ffffff !important;\n\t\t\t\tborder-color: #555 !important;\n\t\t\t}\n\n\t\t\thtml[data-nightly-theme="dark"] input::placeholder,\n\t\t\thtml[data-nightly-theme="dark"] textarea::placeholder {\n\t\t\t\tcolor: #aaa !important;\n\t\t\t}\n\t\t'}analyzeElementColors(t){const e=window.getComputedStyle(t),n=e.backgroundColor;if(e.color,n&&"rgba(0, 0, 0, 0)"!==n){const t=n.match(/\d+/g);if(t)return(parseInt(t[0])+parseInt(t[1])+parseInt(t[2]))/3>200}return!1}cleanup(){this.observer&&(this.observer.disconnect(),this.observer=null),this.styleElement&&(this.styleElement.remove(),this.styleElement=null),this.updateTimeout&&clearTimeout(this.updateTimeout)}}let i;function r(){const t=window.nightlySettings||{},e={respectSystemPreference:!1!==t.respectSystemPreference,transitionDuration:Math.max(0,Math.min(1e3,t.transitionDuration||200)),intensity:Math.max(0,Math.min(1,t.intensity||.8)),contrast:Math.max(.5,Math.min(2,t.contrast||1)),brightness:Math.max(.3,Math.min(1.5,t.brightness||.9)),sepia:Math.max(0,Math.min(1,t.sepia||.1))};i=new a(e),t.debug&&(window.nightlyToggle=i),window.nightlyCustomize=function(t){i&&(Object.assign(i.options,t),i.getCurrentTheme()===i.themes.DARK&&i.applyDynamicStyles(i.themes.DARK))}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r(),t.exports&&(t.exports={NightlyToggle:a})}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={id:a,loaded:!1,exports:{}};return t[a](r,r.exports,n),r.loaded=!0,r.exports}n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n(459)})();
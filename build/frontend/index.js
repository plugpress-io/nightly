(()=>{"use strict";var t={31:(t,e,n)=>{class a{constructor(t={}){this.themes={LIGHT:"light",DARK:"dark"},this.modes={AUTO:"auto",MANUAL:"manual"},this.options={respectSystemPreference:!0,mode:"manual",transitionDuration:200,auto:{intensity:.05,contrast:1.15,brightness:.98,sepia:.15},...t},this.initialize()}initialize(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{this.initializeCore()}):this.initializeCore()}initializeCore(){this.loadSavedSettings(),this.setupDynamicStyleInjection(),this.setupSystemPreferenceListener(),this.bindEvents(),setTimeout(()=>{this.verifyThemePersistence()},100)}verifyThemePersistence(){const t=localStorage.getItem("nightly-theme-preference"),e=this.getCurrentTheme();t&&t!==e&&this.setTheme(t)}loadSavedSettings(){const t=this.getSavedTheme(),e=this.getSavedMode();this.setMode(e),this.setTheme(t)}getSavedTheme(){const t=localStorage.getItem("nightly-theme-preference");return t||(this.options.respectSystemPreference?this.getSystemPreference():this.themes.LIGHT)}getSavedMode(){return localStorage.getItem("nightly-mode-preference")||this.options.mode}getSystemPreference(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?this.themes.DARK:this.themes.LIGHT}saveTheme(t){localStorage.setItem("nightly-theme-preference",t)}saveMode(t){localStorage.setItem("nightly-mode-preference",t)}getCurrentTheme(){return document.documentElement.getAttribute("data-nightly-theme")||this.themes.LIGHT}getCurrentMode(){return document.documentElement.getAttribute("data-nightly-mode")||this.modes.MANUAL}setTheme(t){document.documentElement.setAttribute("data-nightly-theme",t),this.saveTheme(t),this.getCurrentMode()&&t===this.themes.DARK?this.applyDynamicStyles():t===this.themes.DARK||this.removeDarkStyles(),this.dispatchChangeEvent()}setMode(t){document.documentElement.setAttribute("data-nightly-mode",t),this.saveMode(t),this.getCurrentTheme()===this.themes.DARK&&this.applyDynamicStyles(),this.dispatchChangeEvent()}toggleTheme(){const t=this.getCurrentTheme()===this.themes.LIGHT?this.themes.DARK:this.themes.LIGHT;this.setTheme(t)}toggleMode(){const t=this.getCurrentMode()===this.modes.AUTO?this.modes.MANUAL:this.modes.AUTO;this.setMode(t)}dispatchChangeEvent(){const t=new CustomEvent("nightlyChange",{detail:{theme:this.getCurrentTheme(),mode:this.getCurrentMode()}});window.dispatchEvent(t)}bindEvents(){document.addEventListener("click",t=>{const e=t.target.closest("[data-nightly-toggle]");if(!e)return;t.preventDefault();const n=e.getAttribute("data-nightly-toggle");"theme"===n?this.toggleTheme():"mode"===n&&this.toggleMode()})}setupSystemPreferenceListener(){if(!window.matchMedia)return;const t=window.matchMedia("(prefers-color-scheme: dark)");t.addEventListener&&t.addEventListener("change",t=>{this.options.respectSystemPreference&&!localStorage.getItem("nightly-theme-preference")&&this.setTheme(t.matches?this.themes.DARK:this.themes.LIGHT)})}setupDynamicStyleInjection(){const t=document.getElementById("nightly-dynamic-styles");t&&t.remove(),this.styleElement=document.createElement("style"),this.styleElement.id="nightly-dynamic-styles",document.head?document.head.appendChild(this.styleElement):"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{document.head.appendChild(this.styleElement)}):setTimeout(()=>{document.head&&document.head.appendChild(this.styleElement)},0)}applyDynamicStyles(){const t=this.getCurrentMode(),e=(this.getCurrentTheme(),this.generateDynamicCSS(t));if(this.styleElement||this.setupDynamicStyleInjection(),this.styleElement)try{this.styleElement.textContent=e}catch(t){this.styleElement.innerHTML=e}else console.error("Nightly: Could not create style element")}generateDynamicCSS(t){if(t===this.modes.AUTO){const t=this.options.auto,{intensity:e,contrast:n,brightness:a,sepia:o}=t;return`\n\t\t\t\thtml[data-nightly-theme="dark"][data-nightly-mode="auto"] {\n\t\t\t\t\tfilter: invert(${e}) contrast(${n}) brightness(${a}) sepia(${o});\n\t\t\t\t}\n\t\t\t\thtml[data-nightly-theme="dark"][data-nightly-mode="auto"] img,\n\t\t\t\thtml[data-nightly-theme="dark"][data-nightly-mode="auto"] video {\n\t\t\t\t\tfilter: invert(${e}) contrast(${1/n}) brightness(${1/a});\n\t\t\t\t}\n\t\t\t`}return'\n\t\t\t\thtml[data-nightly-theme="dark"] {\n\t\t\t\t\tcolor-scheme: dark !important;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\thtml[data-nightly-theme="dark"] body,\n\t\t\t\thtml[data-nightly-theme="dark"] body.astra-theme,\n\t\t\t\thtml[data-nightly-theme="dark"].astra-theme body {\n\t\t\t\t\tbackground: #0d1117 !important;\n\t\t\t\t\tbackground-color: #0d1117 !important;\n\t\t\t\t\tcolor: #e6edf3 !important;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\thtml[data-nightly-theme="dark"] *,\n\t\t\t\thtml[data-nightly-theme="dark"] h1,\n\t\t\t\thtml[data-nightly-theme="dark"] h2,\n\t\t\t\thtml[data-nightly-theme="dark"] h3,\n\t\t\t\thtml[data-nightly-theme="dark"] h4,\n\t\t\t\thtml[data-nightly-theme="dark"] h5,\n\t\t\t\thtml[data-nightly-theme="dark"] h6,\n\t\t\t\thtml[data-nightly-theme="dark"] p,\n\t\t\t\thtml[data-nightly-theme="dark"] span,\n\t\t\t\thtml[data-nightly-theme="dark"] div,\n\t\t\t\thtml[data-nightly-theme="dark"] li,\n\t\t\t\thtml[data-nightly-theme="dark"] .entry-title,\n\t\t\t\thtml[data-nightly-theme="dark"] .entry-content {\n\t\t\t\t\tcolor: #e6edf3 !important;\n\t\t\t\t\tbackground: transparent !important;\n\t\t\t\t\tbackground-color: transparent !important;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\thtml[data-nightly-theme="dark"] a,\n\t\t\t\thtml[data-nightly-theme="dark"] .entry-title a {\n\t\t\t\t\tcolor: #79c0ff !important;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\thtml[data-nightly-theme="dark"] a:hover,\n\t\t\t\thtml[data-nightly-theme="dark"] .entry-title a:hover {\n\t\t\t\t\tcolor: #a5d6ff !important;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\thtml[data-nightly-theme="dark"] .site-header,\n\t\t\t\thtml[data-nightly-theme="dark"] .site-content,\n\t\t\t\thtml[data-nightly-theme="dark"] .site-footer,\n\t\t\t\thtml[data-nightly-theme="dark"] .ast-container,\n\t\t\t\thtml[data-nightly-theme="dark"] article,\n\t\t\t\thtml[data-nightly-theme="dark"] .ast-article-post,\n\t\t\t\thtml[data-nightly-theme="dark"] .ast-article-inner,\n\t\t\t\thtml[data-nightly-theme="dark"] .post-content,\n\t\t\t\thtml[data-nightly-theme="dark"] #content,\n\t\t\t\thtml[data-nightly-theme="dark"] #primary,\n\t\t\t\thtml[data-nightly-theme="dark"] .content-area,\n\t\t\t\thtml[data-nightly-theme="dark"] .site-main,\n\t\t\t\thtml[data-nightly-theme="dark"] #main {\n\t\t\t\t\tbackground: #0d1117 !important;\n\t\t\t\t\tbackground-color: #0d1117 !important;\n\t\t\t\t\tcolor: #e6edf3 !important;\n\t\t\t\t\tborder: none !important;\n\t\t\t\t\tbox-shadow: none !important;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\thtml[data-nightly-theme="dark"] .nightly-ignore,\n\t\t\t\thtml[data-nightly-theme="dark"] .nightly-ignore * {\n\t\t\t\t\tbackground: initial !important;\n\t\t\t\t\tcolor: initial !important;\n\t\t\t\t}\n\t\t\t'}removeDarkStyles(){this.styleElement&&(this.styleElement.textContent="")}createToggleButton(t={}){const{toggleType:e="theme",showText:n=!0,mode:a="manual"}=t,o=document.createElement("button");return o.className="nightly-toggle",o.setAttribute("data-nightly-toggle",e),o.setAttribute("aria-label","Toggle dark mode"),o.innerHTML='\n\t\t\t<svg class="nightly-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n\t\t\t\t<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>\n\t\t\t</svg>\n\t\t'+(n?"<span>Dark Mode</span>":""),o}cleanup(){this.styleElement&&this.styleElement.remove()}}t=n.hmd(t);class o{constructor(t={}){this.options=t,this.core=null,this.floatingToggle=null,this.init()}init(){this.core=new a(this.options),this.maybeCreateFloatingToggle(),document.addEventListener("nightlyChange",t=>{this.handleCoreChange(t.detail)})}handleCoreChange(t){this.floatingToggle&&this.updateFloatingToggle(t)}updateFloatingToggle(t){const{theme:e}=t,n=window.nightlySettings||{},a=n.floatingBgColor||"#333333",o=n.floatingBgColorActive||"#79c0ff";if(this.floatingToggle.setAttribute("aria-pressed","dark"===e?"true":"false"),this.floatingToggle.style.background="dark"===e?o:a,"sun-moon"===n.floatingIconType){const t="dark"===e;this.floatingToggle.innerHTML=t?'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path fill-rule="evenodd" d="M7.455 2.004a.75.75 0 0 1 .26.77 7 7 0 0 0 9.958 7.967.75.75 0 0 1 1.067.853A8.5 8.5 0 1 1 6.647 1.921a.75.75 0 0 1 .808.083Z" clip-rule="evenodd"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path d="M10 2a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 2ZM10 15a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 15ZM10 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6ZM15.657 5.404a.75.75 0 1 0-1.06-1.06l-1.061 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM6.464 14.596a.75.75 0 1 0-1.06-1.06l-1.06 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM18 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 18 10ZM5 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 5 10ZM14.596 15.657a.75.75 0 0 0 1.06-1.06l-1.06-1.061a.75.75 0 1 0-1.06 1.06l1.06 1.06ZM5.404 6.464a.75.75 0 0 0 1.06-1.06l-1.06-1.06a.75.75 0 1 0-1.061 1.06l1.06 1.06Z"></path></svg>'}}maybeCreateFloatingToggle(){const t=document.getElementById("nightly-floating-toggle-placeholder"),e=window.nightlySettings||{};t&&"true"===t.getAttribute("data-auto-inject")?this.createFloatingToggle():!0!==e.autoInject||this.createFloatingToggle()}createFloatingToggle(){const t=window.nightlySettings||{},e=document.getElementById("nightly-floating-toggle-placeholder");let n={};if(e&&e.getAttribute("data-settings"))try{n=JSON.parse(e.getAttribute("data-settings"))}catch(t){console.warn("Nightly: Failed to parse placeholder settings:",t)}const a=n.floating_position||t.floatingPosition||"bottom-right",o=t.floatingButtonStyle||"rounded",i=t.floatingButtonSize||"medium",l=n.floating_bg_color||t.floatingBgColor||"#333333",r=t.floatingBgColorHover||"#555555",h=(t.floatingBgColorActive,t.floatingIconColor||"#ffffff"),s=t.floatingIconColorHover||"#ffffff",d=t.floatingBorderColor||"transparent",g=t.floatingBorderWidth||0,m=t.floatingBorderRadius||50,c=t.floatingIconSize||24,y=t.floatingIconType||"moon",u=t.floatingCustomIcon||"🌙",p=t.floatingPaddingTop||12,f=t.floatingPaddingBottom||12,v=t.floatingPaddingLeft||16,T=t.floatingPaddingRight||16,M=t.floatingBoxShadow||"0 2px 4px rgba(0,0,0,0.1)",C=t.floatingBoxShadowHover||"0 4px 8px rgba(0,0,0,0.15)",k=n.floating_width||t.floatingWidth||"3.5rem",w=n.floating_height||t.floatingHeight||"3.5rem";let S="🌙";"custom"===y?S=u:"sun"===y?S="☀️":"sun-moon"===y&&(S=this.createSunMoonIcon()),this.floatingToggle=document.createElement("button"),this.floatingToggle.innerHTML=S,this.floatingToggle.setAttribute("aria-label","Toggle dark mode"),this.floatingToggle.setAttribute("aria-pressed","false"),this.floatingToggle.className=`nightly-floating-toggle position-${a} nightly-button-${o} nightly-button-${i}`,this.floatingToggle.style.cssText=`\n\t\t\tposition: fixed;\n\t\t\tz-index: 9999;\n\t\t\twidth: ${k};\n\t\t\theight: ${w};\n\t\t\tpadding: ${p}px ${T}px ${f}px ${v}px;\n\t\t\tbackground: ${l};\n\t\t\tcolor: ${h};\n\t\t\tborder: ${g}px solid ${d};\n\t\t\tborder-radius: ${m}%;\n\t\t\tcursor: pointer;\n\t\t\ttransition: all 0.2s ease;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tfont-size: ${c}px;\n\t\t\tbox-shadow: ${M};\n\t\t\t${a.includes("bottom")?"bottom: 20px;":"top: 20px;"}\n\t\t\t${a.includes("right")?"right: 20px;":"left: 20px;"}\n\t\t`;const b=`\n\t\t\t.nightly-floating-toggle:hover {\n\t\t\t\tbackground-color: ${r} !important;\n\t\t\t\tcolor: ${s} !important;\n\t\t\t\tbox-shadow: ${C} !important;\n\t\t\t}\n\t\t`;if(!document.getElementById("nightly-floating-toggle-styles")){const t=document.createElement("style");t.id="nightly-floating-toggle-styles",t.textContent=b,document.head.appendChild(t)}document.body.appendChild(this.floatingToggle),this.floatingToggle.addEventListener("click",()=>{this.toggleTheme()}),document.addEventListener("nightlyChange",t=>{this.updateFloatingToggle({theme:t.detail.theme,mode:t.detail.mode})}),window.addEventListener("nightlyChange",t=>{this.updateFloatingToggle({theme:t.detail.theme,mode:t.detail.mode})}),this.updateFloatingToggle({theme:this.core.getCurrentTheme(),mode:this.core.getCurrentMode()})}getCurrentTheme(){return this.core?this.core.getCurrentTheme():"light"}getCurrentMode(){return this.core?this.core.getCurrentMode():"dark"}toggleTheme(){this.core&&this.core.toggleTheme()}toggleMode(){this.core&&this.core.toggleMode()}cleanup(){this.core&&(this.core.cleanup(),this.core=null),this.floatingToggle&&(this.floatingToggle.remove(),this.floatingToggle=null)}createSunMoonIcon(){return"dark"===this.core.getCurrentTheme()?'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path fill-rule="evenodd" d="M7.455 2.004a.75.75 0 0 1 .26.77 7 7 0 0 0 9.958 7.967.75.75 0 0 1 1.067.853A8.5 8.5 0 1 1 6.647 1.921a.75.75 0 0 1 .808.083Z" clip-rule="evenodd"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path d="M10 2a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 2ZM10 15a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 10 15ZM10 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6ZM15.657 5.404a.75.75 0 1 0-1.06-1.06l-1.061 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM6.464 14.596a.75.75 0 1 0-1.06-1.06l-1.06 1.06a.75.75 0 0 0 1.06 1.06l1.06-1.06ZM18 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 18 10ZM5 10a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 5 10ZM14.596 15.657a.75.75 0 0 0 1.06-1.06l-1.06-1.061a.75.75 0 1 0-1.06 1.06l1.06 1.06ZM5.404 6.464a.75.75 0 0 0 1.06-1.06l-1.06-1.06a.75.75 0 1 0-1.061 1.06l1.06 1.06Z"></path></svg>'}}let i;function l(){const t=window.nightlySettings||{},e=localStorage.getItem("nightly-mode-preference"),n=localStorage.getItem("nightly-theme-preference"),a={respectSystemPreference:!1!==t.respectSystemPreference,mode:e||t.mode||"manual",transitionDuration:Math.max(0,Math.min(1e3,t.transitionDuration||200)),ignoreSelectors:t.ignoreSelectors||"",auto:{intensity:Math.max(0,Math.min(1,t.autoIntensity||.05)),contrast:Math.max(.5,Math.min(2,t.autoContrast||1.15)),brightness:Math.max(.3,Math.min(1.5,t.autoBrightness||.98)),sepia:Math.max(0,Math.min(1,t.autoSepia||.15))}};i=new o(a),t.mode&&!e&&localStorage.setItem("nightly-mode-preference",t.mode),t.theme&&!n&&localStorage.setItem("nightly-theme-preference",t.theme),window.nightlyFrontend=i,window.nightlyCore=i.core,window.addEventListener("nightlySettingsChanged",t=>{const{settings:e}=t.detail;e.mode&&localStorage.setItem("nightly-mode-preference",e.mode),e.theme&&localStorage.setItem("nightly-theme-preference",e.theme),i&&i.core&&(e.mode&&i.core.setMode(e.mode),e.theme&&i.core.setTheme(e.theme))})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l(),t.exports&&(t.exports={NightlyFrontend:o,NightlyCore:a}),window.Nightly={Frontend:o,Core:a}}},e={};function n(a){var o=e[a];if(void 0!==o)return o.exports;var i=e[a]={id:a,loaded:!1,exports:{}};return t[a](i,i.exports,n),i.loaded=!0,i.exports}n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n(31)})();
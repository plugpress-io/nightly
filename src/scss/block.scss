/**
 * Block Styles
 *
 * @package Nightly
 */

@import 'tokens';
@import 'mixins';
@import 'base';

// =============================================================================
// BASE BLOCK STYLES
// =============================================================================

.wp-block-nightly-toggle {
  // Base block container
  margin: var(--nightly-space-md) 0;
  
  // Ensure proper font family inheritance
  font-family: var(--nightly-font-family-base);
  
  // Block alignment support
  &.alignleft {
    text-align: left;
  }
  
  &.aligncenter {
    text-align: center;
  }
  
  &.alignright {
    text-align: right;
  }
  
  &.alignwide,
  &.alignfull {
    margin-left: auto;
    margin-right: auto;
  }
  
  // Block toggle button styles
  .nightly-toggle-button {
    @include button-secondary;
    @include touch-target(44px);
    @include focus-management;
    @include button-states-accessible;
    
    // Icon and text layout
    display: inline-flex;
    align-items: center;
    gap: var(--nightly-space-xs);
    
    .nightly-toggle-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 20px;
      
      // Ensure icons are hidden from screen readers
      &[aria-hidden="true"] {
        pointer-events: none;
      }
      
      // Theme-based icon visibility
      .nightly-icon-light {
        display: block;
      }
      
      .nightly-icon-dark {
        display: none;
      }
    }
    
    // Dark theme icon switching
    [data-nightly-theme="dark"] & {
      .nightly-toggle-icon {
        .nightly-icon-light {
          display: none;
        }
        
        .nightly-icon-dark {
          display: block;
        }
      }
    }
    
    // Enhanced focus states with better visibility
    &:focus,
    &.nightly-focused {
      @include focus-ring-enhanced;
      z-index: 1;
      
      // Enhanced focus ring for better visibility
      box-shadow: 0 0 0 4px rgba(0, 132, 96, 0.2);
      
      @include high-contrast {
        box-shadow: 0 0 0 4px Highlight;
      }
      
      @include forced-colors {
        box-shadow: 0 0 0 4px Highlight;
      }
    }
    
    // High contrast enhancements
    &.nightly-high-contrast-focus {
      @include high-contrast {
        border-width: 3px;
        
        &:focus,
        &.nightly-focused {
          outline: 4px solid Highlight;
          outline-offset: 3px;
          box-shadow: 0 0 0 6px Highlight;
        }
      }
      
      @include forced-colors {
        border-width: 3px;
        
        &:focus,
        &.nightly-focused {
          outline: 4px solid Highlight;
          outline-offset: 3px;
          box-shadow: 0 0 0 6px Highlight;
        }
      }
    }
    
    // Reduced motion support
    @include reduced-motion {
      transition: none;
    }
  }
}

// Block editor specific styles
.editor-styles-wrapper .wp-block-nightly-toggle {
  // Ensure proper styling in the block editor
  font-family: var(--nightly-font-family-base);
  
  .nightly-toggle-button {
    // Editor preview styling
    &.is-toggled {
      background-color: var(--nightly-interactive-primary);
      color: var(--nightly-text-inverse);
      border-color: var(--nightly-interactive-primary);
    }
  }
  
  .nightly-editor-notice {
    margin-top: var(--nightly-space-xs);
    font-size: var(--nightly-font-size-xs);
    color: var(--nightly-text-secondary);
    font-style: italic;
    
    // Ensure editor notice is accessible
    &[role="note"] {
      padding: var(--nightly-space-xs);
      border-left: 3px solid var(--nightly-border-secondary);
      
      @include high-contrast {
        border-left-color: Highlight;
      }
      
      @include forced-colors {
        border-left-color: Highlight;
      }
    }
  }
}

// =============================================================================
// BLOCK ACCESSIBILITY ENHANCEMENTS
// =============================================================================

// Screen reader content for blocks
.wp-block-nightly-toggle {
  .screen-reader-text {
    @include sr-only;
  }
  
  .nightly-sr-state {
    @include sr-only;
  }
  
  .nightly-toggle-description {
    @include sr-only;
  }
}

// High contrast mode enhancements for blocks
.nightly-high-contrast {
  .wp-block-nightly-toggle {
    .nightly-toggle-button {
      @include forced-colors {
        background: ButtonFace;
        color: ButtonText;
        border-color: ButtonText;
        
        &:hover {
          background: Highlight;
          color: HighlightText;
          border-color: Highlight;
        }
        
        &:focus {
          outline: 3px solid Highlight;
          outline-offset: 2px;
        }
        
        &[aria-pressed="true"] {
          background: Highlight;
          color: HighlightText;
          border-color: Highlight;
        }
        
        &:disabled {
          background: GrayText;
          color: HighlightText;
          border-color: GrayText;
        }
      }
    }
  }
}

// Touch device optimizations for blocks
@media (hover: none) and (pointer: coarse) {
  .wp-block-nightly-toggle {
    .nightly-toggle-button {
      @include touch-target(48px);
      
      // Larger tap targets on mobile
      padding: var(--nightly-space-sm) var(--nightly-space-md);
    }
  }
}

// Reduced motion preferences for blocks
@include reduced-motion {
  .wp-block-nightly-toggle {
    .nightly-toggle-button {
      transition: none !important;
      animation: none !important;
    }
  }
}

// Print styles for blocks
@media print {
  .wp-block-nightly-toggle {
    .screen-reader-text,
    .nightly-sr-state,
    .nightly-toggle-description {
      display: none !important;
    }
    
    .nightly-toggle-button {
      background: transparent !important;
      color: black !important;
      border: 1px solid black !important;
      
      &::after {
        content: " (Dark mode toggle)";
        font-size: 0.8em;
      }
      
      .nightly-toggle-icon {
        display: none !important;
      }
    }
  }
}